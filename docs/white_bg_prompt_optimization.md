# 白底生图提示词优化方案

## 1. 目标
优化现有白底生图（White Background Image Generation）的提示词，主要解决以下问题：
- **衣服修平**：消除不美观的褶皱，使衣物看起来更平整。
- **自然感**：在修平的同时，避免“塑料感”或过度PS的痕迹，保持衣物的自然垂坠感和面料质感。
- **遵循原则**：不新增代码轮子，遵循 DRY (Don't Repeat Yourself) 原则，仅修改提示词模板内容。

## 2. 现状分析
目前的提示词构建由 `backend/app/services/prompt_template.py` 中的 `PromptTemplateManager` 管理。
涉及的主要模板为：
1.  `standardize` (产品标准化)：负责形态重建和褶皱处理。
2.  `ecommerce` (电商化渲染)：负责白底背景和光照处理。

### 现有问题
- `standardize` 模板虽然提到了“消除不规则褶皱”，但可能缺乏对“平整度”与“自然感”之间平衡的具体指导，导致生成结果可能过于僵硬或不够平整。
- `ecommerce` 模板中的“理想化面料质感”可能导致过度平滑。

## 3. 优化方案

我们将直接修改 `backend/app/services/prompt_template.py` 中的内置模板字符串。

### 3.1 优化 `standardize` 模板 (产品标准化)

**修改重点**：
- 细化褶皱处理指令，区分“杂乱褶皱”和“结构性褶皱”。
- 强调“自然平整”，即像熨烫过的效果，而不是像充气或塑料模型。

**原提示词片段**：
```markdown
褶皱处理：
- 消除拍摄导致的真实不规则褶皱
- 重建为电商展示标准的平整形态
- 严格保留面料的自然纹理
```

**优化后提示词片段**：
```markdown
褶皱处理（自然熨烫效果）：
- 智能识别并消除由于堆叠、挤压产生的杂乱褶皱
- 保留衣物自然的垂坠褶皱和结构性褶皱（如袖口、收腰处的自然起伏）
- 模拟专业蒸汽熨烫后的平整效果，而非完全的平面化
- 确保面料在平整的同时展现出应有的重力感和柔软度
```

### 3.2 优化 `ecommerce` 模板 (电商化渲染)

**修改重点**：
- 调整光照描述，增强立体感和自然感。
- 强调“真实质感”而非“理想化质感”。

**原提示词片段**：
```markdown
产品优化：
- 清晰平整的理想化面料质感
- 色彩饱和度适中，接近实物
- 细节清晰可辨
```

**优化后提示词片段**：
```markdown
产品优化：
- 展现面料真实的微观纹理（如棉麻的粗糙感、丝绸的光泽感）
- 避免过度磨皮或塑料感，保持材质的透气感
- 色彩还原自然，避免过度饱和
- 边缘光影处理自然，与白底融合但不生硬切割
```

## 4. 实施计划
1.  修改 `backend/app/services/prompt_template.py` 文件中的 `_load_builtin_templates` 方法。
2.  更新 `standardize` 和 `ecommerce` 模板的 `prompt_template` 字段。
3.  保持原有代码结构不变，不增加新的类或函数。
